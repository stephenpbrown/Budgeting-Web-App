@model BudgetingWebApp.ViewModels.MainViewModel

@{
    ViewBag.Title = Model.Budget.BudgetMonth;
    int budgetID = Model.Budget.BudgetID;
    string userID = Model.Budget.UserID;
}

<h2>@Model.Budget.BudgetMonth</h2>

<style type="text/css">
    table {
        width: 700px;
        border: double;
    }

    th {
        width: 100px;
    }

    td {
        border: double;
        width: 100px;
    }

    input {
        width: 100px;
    }
</style>

<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="functions.js"></script>

<p>
    @Html.ActionLink("Create New Category", "Create", "MainCategory", new { budgetID = budgetID }, null)
</p>

<div>
    <table style="width:100%">
        <thead>
            <tr>
                <th>
                    Name
                </th>
                <th>
                    Allotment
                </th>
                <th>
                    Actual
                </th>
                <th></th>
            </tr>
        </thead>
        @foreach (var MC in Model.MainCategory)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => MC.Name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => MC.Allotment)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => MC.Actual)
                </td>
                <td align="center">
                    @Html.ActionLink("Create Sub-Category", "Create", "SubCategory", new { id = MC.MainCategoryID, budgetID = budgetID, mainCategoryName = Html.DisplayFor(modelItem => MC.Name) }, null) |
                    @Html.ActionLink("Delete", "Delete", "MainCategory", new { id = MC.MainCategoryID, budgetID = budgetID }, null)
                </td>
            </tr>
            foreach(var SC in Model.SubCategory)
            {
                if (SC.MainCategoryID == MC.MainCategoryID)
                {
                    
                    <tr align="center">
                        <td>
                            @Html.DisplayFor(modelItem => SC.Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => SC.Allotment)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => SC.Actual)
                        </td>
                        <td>
                            @Html.ActionLink("Delete", "Delete", "SubCategory", new { id = SC.SubCategoryID, budgetID = budgetID }, null)
                        </td>
                    </tr>
                }
            }
        }
    </table>

    <table>
        <tr>
            <th>
                Total Allotted Amount
            </th>
            <td>
                @Html.DisplayFor(item => item.TotalAllotment)
            </td>
        </tr>
    </table>

</div>


<div>
    @Html.ActionLink("Back to the List of Budgets", "Index", "Budget", new { id = userID })
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
